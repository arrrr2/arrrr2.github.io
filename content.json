{"meta":{"title":"arr2's blog","subtitle":"","description":"","author":"arr2","url":"https://arrrr2.github.io","root":"/"},"pages":[{"title":"文章归档","date":"2023-11-29T07:19:52.041Z","updated":"2023-11-29T07:19:52.041Z","comments":true,"path":"/archive.html","permalink":"https://arrrr2.github.io/archive.html","excerpt":"","text":""},{"title":"关于我","date":"2023-11-29T08:31:40.378Z","updated":"2023-11-29T08:31:40.378Z","comments":true,"path":"/about.html","permalink":"https://arrrr2.github.io/about.html","excerpt":"","text":"一个普通人。"},{"title":"友情链接","date":"2023-11-29T10:59:40.299Z","updated":"2023-11-29T10:59:40.299Z","comments":true,"path":"/friends.html","permalink":"https://arrrr2.github.io/friends.html","excerpt":"","text":"echo 的个人主页"},{"title":"留言板","date":"2023-11-29T11:04:01.052Z","updated":"2023-11-29T11:04:01.052Z","comments":true,"path":"/comment_board.html","permalink":"https://arrrr2.github.io/comment_board.html","excerpt":"","text":"来都来了，要不聊点啥？"},{"title":"","date":"2023-11-29T11:50:53.700Z","updated":"2023-11-29T11:49:46.194Z","comments":true,"path":"images/waline.css","permalink":"https://arrrr2.github.io/images/waline.css","excerpt":"","text":":root{--waline-font-size: 1rem;--waline-white: #fff;--waline-light-grey: #999;--waline-dark-grey: #666;--waline-theme-color: #27ae60;--waline-active-color: #2ecc71;--waline-color: #444;--waline-bgcolor: #fff;--waline-bgcolor-light: #f8f8f8;--waline-bgcolor-hover: #f0f0f0;--waline-border-color: #ddd;--waline-disable-bgcolor: #f8f8f8;--waline-disable-color: #000;--waline-code-bgcolor: #282c34;--waline-bq-color: #f0f0f0;--waline-avatar-size: 3.25rem;--waline-m-avatar-size: calc(var(--waline-avatar-size) * 9 / 13);--waline-badge-color: #3498db;--waline-badge-font-size: 0.75em;--waline-info-bgcolor: #f8f8f8;--waline-info-color: #999;--waline-info-font-size: 0.625em;--waline-border: 1px solid var(--waline-border-color);--waline-avatar-radius: 50%;--waline-box-shadow: none}[data-waline]{font-size:var(--waline-font-size);text-align:start}[dir=rtl] [data-waline]{direction:rtl}[data-waline] *{box-sizing:content-box;line-height:1.75}[data-waline] p{color:var(--waline-color)}[data-waline] a{position:relative;display:inline-block;color:var(--waline-theme-color);text-decoration:none;word-break:break-word;cursor:pointer}[data-waline] a:hover{color:var(--waline-active-color)}[data-waline] img{max-width:100%;max-height:400px;border:none}[data-waline] hr{margin:.825em 0;border-style:dashed;border-color:var(--waline-bgcolor-light)}[data-waline] code,[data-waline] pre{margin:0;padding:.2em .4em;border-radius:3px;background:var(--waline-bgcolor-light);font-size:85%}[data-waline] pre{overflow:auto;padding:10px;line-height:1.45}[data-waline] pre::-webkit-scrollbar{width:6px;height:6px}[data-waline] pre::-webkit-scrollbar-track-piece:horizontal{-webkit-border-radius:6px;border-radius:6px;background:rgba(0,0,0,.1)}[data-waline] pre::-webkit-scrollbar-thumb:horizontal{width:6px;-webkit-border-radius:6px;border-radius:6px;background:var(--waline-theme-color)}[data-waline] pre code{padding:0;background:rgba(0,0,0,0);color:var(--waline-color);white-space:pre-wrap;word-break:keep-all}[data-waline] blockquote{margin:.5em 0;padding:.5em 0 .5em 1em;border-inline-start:8px solid var(--waline-bq-color);color:var(--waline-dark-grey)}[data-waline] blockquote>p{margin:0}[data-waline] ol,[data-waline] ul{margin-inline-start:1.25em;padding:0}[data-waline] input[type=checkbox],[data-waline] input[type=radio]{display:inline-block;vertical-align:middle;margin-top:-2px}.wl-btn{display:inline-block;vertical-align:middle;min-width:2.5em;margin-bottom:0;padding:.5em 1em;border:1px solid var(--waline-border-color);border-radius:.5em;background:rgba(0,0,0,0);color:var(--waline-color);font-weight:400;font-size:.75em;line-height:1.5;text-align:center;white-space:nowrap;cursor:pointer;user-select:none;transition-duration:.4s;touch-action:manipulation}.wl-btn:hover,.wl-btn:active{border-color:var(--waline-theme-color);color:var(--waline-theme-color)}.wl-btn:disabled{border-color:var(--waline-border-color);background:var(--waline-disable-bgcolor);color:var(--waline-disable-color);cursor:not-allowed}.wl-btn.primary{border-color:var(--waline-theme-color);background:var(--waline-theme-color);color:var(--waline-white)}.wl-btn.primary:hover,.wl-btn.primary:active{border-color:var(--waline-active-color);background:var(--waline-active-color);color:var(--waline-white)}.wl-btn.primary:disabled{border-color:var(--waline-border-color);background:var(--waline-disable-bgcolor);color:var(--waline-disable-color);cursor:not-allowed}.wl-loading{text-align:center}.wl-loading svg{margin:0 auto}.wl-comment{position:relative;display:flex;margin-bottom:.75em}.wl-close{position:absolute;top:-4px;inset-inline-end:-4px;padding:0;border:none;background:rgba(0,0,0,0);line-height:1;cursor:pointer}.wl-login-info{max-width:80px;margin-top:.75em;text-align:center}.wl-logout-btn{position:absolute;top:-10px;inset-inline-end:-10px;padding:3px;border:none;background:rgba(0,0,0,0);line-height:0;cursor:pointer}.wl-avatar{position:relative;width:var(--waline-avatar-size);height:var(--waline-avatar-size);margin:0 auto;border:var(--waline-border);border-radius:var(--waline-avatar-radius)}@media(max-width: 720px){.wl-avatar{width:var(--waline-m-avatar-size);height:var(--waline-m-avatar-size)}}.wl-avatar img{width:100%;height:100%;border-radius:var(--waline-avatar-radius)}.wl-login-nick{display:block;color:var(--waline-theme-color);font-size:.75em;word-break:break-all}.wl-panel{position:relative;flex-shrink:1;width:100%;margin:.5em;border:var(--waline-border);border-radius:.75em;background:var(--waline-bgcolor);box-shadow:var(--waline-box-shadow)}.wl-header{display:flex;overflow:hidden;padding:0 4px;border-bottom:2px dashed var(--waline-border-color);border-top-left-radius:.75em;border-top-right-radius:.75em}@media(max-width: 580px){.wl-header{display:block}}.wl-header label{min-width:40px;padding:.75em .5em;color:var(--waline-color);font-size:.75em;text-align:center}.wl-header input{flex:1;width:0;padding:.5em;background:rgba(0,0,0,0);font-size:.625em;resize:none}.wl-header-item{display:flex;flex:1}@media(max-width: 580px){.wl-header-item:not(:last-child){border-bottom:2px dashed var(--waline-border-color)}}.wl-header-1 .wl-header-item{width:100%}.wl-header-2 .wl-header-item{width:50%}@media(max-width: 580px){.wl-header-2 .wl-header-item{flex:0;width:100%}}.wl-header-3 .wl-header-item{width:33.33%}@media(max-width: 580px){.wl-header-3 .wl-header-item{width:100%}}.wl-editor{position:relative;width:calc(100% - 1em);min-height:8.75em;margin:.75em .5em;border-radius:.5em;background:rgba(0,0,0,0);font-size:.875em;resize:vertical}.wl-editor,.wl-input{max-width:100%;border:none;color:var(--waline-color);outline:none;transition:all .25s ease}.wl-editor:focus,.wl-input:focus{background:var(--waline-bgcolor-light)}.wl-preview{padding:0 .5em .5em}.wl-preview h4{margin:.25em;font-weight:bold;font-size:.9375em}.wl-preview .wl-content{min-height:1.25em;padding:.25em;word-break:break-word;hyphens:auto}.wl-preview .wl-content>*:first-child{margin-top:0}.wl-preview .wl-content>*:last-child{margin-bottom:0}.wl-footer{position:relative;display:flex;flex-wrap:wrap;margin:.5em .75em}.wl-actions{display:flex;flex:2;align-items:center}.wl-action{display:inline-flex;align-items:center;justify-content:center;width:1.5em;height:1.5em;margin:2px;padding:0;border:none;background:rgba(0,0,0,0);color:var(--waline-color);font-size:16px;cursor:pointer}.wl-action:hover{color:var(--waline-theme-color)}.wl-action.active{color:var(--waline-active-color)}#wl-image-upload{display:none}#wl-image-upload:focus+label{color:var(--waline-color)}#wl-image-upload:focus-visible+label{outline:-webkit-focus-ring-color auto 1px}.wl-info{display:flex;flex:3;align-items:center;justify-content:flex-end}.wl-info .wl-text-number{color:var(--waline-info-color);font-size:.75em}.wl-info .wl-text-number .illegal{color:red}.wl-info button{margin-inline-start:.75em}.wl-info button svg{display:block;margin:0 auto;line-height:18px}.wl-emoji-popup{position:absolute;top:100%;inset-inline-start:1.25em;z-index:10;max-width:526px;border:var(--waline-border);border-radius:6px;background:var(--waline-bgcolor);box-shadow:var(--waline-box-shadow);opacity:0;visibility:hidden;transition:transform .2s ease-out,opacity .2s ease-out;transform:scale(0.9, 0.9);transform-origin:0 0}.wl-emoji-popup.display{opacity:1;visibility:visible;transform:none}.wl-emoji-popup button{display:inline-block;vertical-align:middle;width:2em;margin:.125em;padding:0;border-width:0;background:rgba(0,0,0,0);font-size:inherit;line-height:2;text-align:center;cursor:pointer}.wl-emoji-popup button:hover{background:var(--waline-bgcolor-hover)}.wl-emoji-popup .wl-emoji{display:inline-block;vertical-align:middle;max-width:1.5em;max-height:1.5em}.wl-emoji-popup .wl-tab-wrapper{overflow-y:auto;max-height:145px;padding:.5em}.wl-emoji-popup .wl-tab-wrapper::-webkit-scrollbar{width:6px;height:6px}.wl-emoji-popup .wl-tab-wrapper::-webkit-scrollbar-track-piece:vertical{-webkit-border-radius:6px;border-radius:6px;background:rgba(0,0,0,.1)}.wl-emoji-popup .wl-tab-wrapper::-webkit-scrollbar-thumb:vertical{width:6px;-webkit-border-radius:6px;border-radius:6px;background:var(--waline-theme-color)}.wl-emoji-popup .wl-tabs{position:relative;overflow-x:auto;padding:0 6px;white-space:nowrap}.wl-emoji-popup .wl-tabs::before{content:\" \";position:absolute;top:0;right:0;left:0;z-index:2;height:1px;background:var(--waline-border-color)}.wl-emoji-popup .wl-tabs::-webkit-scrollbar{width:6px;height:6px}.wl-emoji-popup .wl-tabs::-webkit-scrollbar-track-piece:horizontal{-webkit-border-radius:6px;border-radius:6px;background:rgba(0,0,0,.1)}.wl-emoji-popup .wl-tabs::-webkit-scrollbar-thumb:horizontal{height:6px;-webkit-border-radius:6px;border-radius:6px;background:var(--waline-theme-color)}.wl-emoji-popup .wl-tab{position:relative;margin:0;padding:0 .5em}.wl-emoji-popup .wl-tab.active{z-index:3;border:1px solid var(--waline-border-color);border-top-width:0;border-bottom-right-radius:6px;border-bottom-left-radius:6px;background:var(--waline-bgcolor)}.wl-gif-popup{position:absolute;top:100%;inset-inline-start:1.25em;z-index:10;width:calc(100% - 3em);padding:.75em .75em .25em;border:var(--waline-border);border-radius:6px;background:var(--waline-bgcolor);box-shadow:var(--waline-box-shadow);opacity:0;visibility:hidden;transition:transform .2s ease-out,opacity .2s ease-out;transform:scale(0.9, 0.9);transform-origin:0 0}.wl-gif-popup.display{opacity:1;visibility:visible;transform:none}.wl-gif-popup input{box-sizing:border-box;width:100%;margin-bottom:10px;padding:3px 5px;border:var(--waline-border)}.wl-gif-popup img{display:block;box-sizing:border-box;width:100%;border-width:2px;border-style:solid;border-color:#fff;cursor:pointer}.wl-gif-popup img:hover{border-color:var(--waline-theme-color);border-radius:2px}.wl-gallery{display:flex;overflow-y:auto;max-height:80vh}.wl-gallery-column{display:flex;flex:1;flex-direction:column;height:-webkit-max-content;height:-moz-max-content;height:max-content}.wl-cards .wl-user{--avatar-size: var(--waline-avatar-size);position:relative;margin-inline-end:.75em}@media(max-width: 720px){.wl-cards .wl-user{--avatar-size: var(--waline-m-avatar-size)}}.wl-cards .wl-user img{width:var(--avatar-size);height:var(--avatar-size);border-radius:var(--waline-avatar-radius);box-shadow:var(--waline-box-shadow)}.wl-cards .wl-user .verified-icon{position:absolute;top:calc(var(--avatar-size)*3/4);inset-inline-start:calc(var(--avatar-size)*3/4);border-radius:50%;background:var(--waline-bgcolor);box-shadow:var(--waline-box-shadow)}.wl-card-item{position:relative;display:flex;padding:.5em}.wl-card-item .wl-card-item{padding-inline-end:0}.wl-card{flex:1;width:0;padding-bottom:.5em;border-bottom:1px dashed var(--waline-border-color)}.wl-card:first-child{margin-inline-start:1em}.wl-card-item:last-child>.wl-card{border-bottom:none}.wl-card .wl-nick svg{position:relative;bottom:-0.125em;line-height:1}.wl-card .wl-head{overflow:hidden;line-height:1.5}.wl-card .wl-head .wl-nick{position:relative;display:inline-block;margin-inline-end:.5em;font-weight:bold;font-size:.875em;line-height:1;text-decoration:none}.wl-card span.wl-nick{color:var(--waline-dark-grey)}.wl-card .wl-badge{display:inline-block;margin-inline-end:1em;padding:0 .3em;border:1px solid var(--waline-badge-color);border-radius:4px;color:var(--waline-badge-color);font-size:var(--waline-badge-font-size)}.wl-card .wl-time{margin-inline-end:.875em;color:var(--waline-info-color);font-size:.75em}.wl-card .wl-meta{position:relative;line-height:1}.wl-card .wl-meta>span{display:inline-block;margin-inline-end:.25em;padding:2px 4px;border-radius:.2em;background:var(--waline-info-bgcolor);color:var(--waline-info-color);font-size:var(--waline-info-font-size);line-height:1.5}.wl-card .wl-meta>span:empty{display:none}.wl-card .wl-comment-actions{float:right;line-height:1}[dir=rtl] .wl-card .wl-comment-actions{float:left}.wl-card .wl-delete,.wl-card .wl-like,.wl-card .wl-reply,.wl-card .wl-edit{display:inline-flex;align-items:center;border:none;background:rgba(0,0,0,0);color:var(--waline-color);line-height:1;cursor:pointer;transition:color .2s ease}.wl-card .wl-delete:hover,.wl-card .wl-like:hover,.wl-card .wl-reply:hover,.wl-card .wl-edit:hover{color:var(--waline-theme-color)}.wl-card .wl-delete.active,.wl-card .wl-like.active,.wl-card .wl-reply.active,.wl-card .wl-edit.active{color:var(--waline-active-color)}.wl-card .wl-content{position:relative;margin-bottom:.75em;padding-top:.625em;font-size:.875em;line-height:2;word-wrap:break-word}.wl-card .wl-content.expand{overflow:hidden;max-height:8em;cursor:pointer}.wl-card .wl-content.expand::before{content:\"\";position:absolute;top:0;bottom:3.15em;inset-inline-start:0;z-index:999;display:block;width:100%;background:linear-gradient(180deg, #000, rgba(255, 255, 255, 0.9))}.wl-card .wl-content.expand::after{content:attr(data-expand);position:absolute;bottom:0;inset-inline-start:0;z-index:999;display:block;width:100%;height:3.15em;background:rgba(255,255,255,.9);color:#828586;line-height:3.15em;text-align:center}.wl-card .wl-content>*:first-child{margin-top:0}.wl-card .wl-content>*:last-child{margin-bottom:0}.wl-card .wl-admin-actions{margin:8px 0;font-size:12px;text-align:right}.wl-card .wl-comment-status{margin:0 8px}.wl-card .wl-comment-status .wl-btn{border-radius:0}.wl-card .wl-comment-status .wl-btn:first-child{border-inline-end:0;border-radius:.5em 0 0 .5em}.wl-card .wl-comment-status .wl-btn:last-child{border-inline-start:0;border-radius:0 .5em .5em 0}.wl-card .wl-quote{border-inline-start:1px dashed rgba(237,237,237,.5)}.wl-card .wl-quote .wl-user{--avatar-size: var(--waline-m-avatar-size)}.wl-close-icon{color:var(--waline-border-color)}.wl-content .vemoji,.wl-content .wl-emoji{display:inline-block;vertical-align:baseline;height:1.25em;margin:-0.125em .25em}.wl-content .wl-tex{background:var(--waline-info-bgcolor);color:var(--waline-info-color)}.wl-content span.wl-tex{display:inline-block;margin-inline-end:.25em;padding:2px 4px;border-radius:.2em;font-size:var(--waline-info-font-size);line-height:1.5}.wl-content p.wl-tex{text-align:center}.wl-content .katex-display{overflow:auto hidden;-webkit-overflow-scrolling:touch;padding-top:.2em;padding-bottom:.2em}.wl-content .katex-display::-webkit-scrollbar{height:3px}.wl-content .katex-error{color:red}.wl-count{flex:1;font-weight:bold;font-size:1.25em}.wl-empty{overflow:auto;padding:1.25em;color:var(--waline-color);text-align:center}.wl-operation{text-align:center}.wl-operation button{margin:1em 0}.wl-power{padding:.5em 0;color:var(--waline-light-grey);font-size:var(--waline-info-font-size);text-align:end}.wl-meta-head{display:flex;flex-direction:row;align-items:center;padding:.375em}.wl-sort{margin:0;list-style-type:none}.wl-sort li{display:inline-block;color:var(--waline-info-color);font-size:.75em;cursor:pointer}.wl-sort li.active{color:var(--waline-theme-color)}.wl-sort li+li{margin-inline-start:1em}.wl-reaction{overflow:auto hidden;margin-bottom:1.75em;text-align:center}.wl-reaction img{width:100%;height:100%;transition:all 250ms ease-in-out}.wl-reaction-title{margin:16px auto;font-weight:bold;font-size:18px}.wl-reaction-list{display:flex;flex-direction:row;gap:16px;justify-content:center;margin:0;padding:8px;list-style-type:none}@media(max-width: 580px){.wl-reaction-list{gap:12px}}[data-waline] .wl-reaction-list{margin-inline-start:0}.wl-reaction-item{display:flex;flex-direction:column;align-items:center;cursor:pointer}.wl-reaction-item:hover img,.wl-reaction-item.active img{transform:scale(1.15)}.wl-reaction-img{position:relative;width:42px;height:42px}@media(max-width: 580px){.wl-reaction-img{width:32px;height:32px}}.wl-reaction-loading{position:absolute;top:-4px;inset-inline-end:-5px;width:18px;height:18px;color:var(--waline-theme-color)}.wl-reaction-votes{position:absolute;top:-9px;inset-inline-end:-9px;min-width:1em;padding:2px;border:1px solid var(--waline-theme-color);border-radius:1em;background:var(--waline-bgcolor);color:var(--waline-theme-color);font-weight:700;font-size:.75em;line-height:1}.wl-reaction-item.active .wl-reaction-votes{background:var(--waline-theme-color);color:var(--waline-bgcolor)}.wl-reaction-text{font-size:.875em}.wl-reaction-item.active .wl-reaction-text{color:var(--waline-theme-color)}.wl-content pre,.wl-content pre[class*=language-]{overflow:auto;margin:.75rem 0;padding:1rem 1.25rem;border-radius:6px;background:var(--waline-code-bgcolor);line-height:1.4}.wl-content pre code,.wl-content pre[class*=language-] code{padding:0;border-radius:0;background:rgba(0,0,0,0) !important;color:#bbb;direction:ltr}.wl-content code[class*=language-],.wl-content pre[class*=language-]{background:none;color:#ccc;font-size:1em;font-family:Consolas,Monaco,\"Andale Mono\",\"Ubuntu Mono\",monospace;text-align:left;white-space:pre;word-spacing:normal;word-wrap:normal;word-break:normal;tab-size:4;hyphens:none}.wl-content pre[class*=language-]{overflow:auto}.wl-content :not(pre)>code[class*=language-],.wl-content pre[class*=language-]{background:#2d2d2d}.wl-content :not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.wl-content .token.comment,.wl-content .token.block-comment,.wl-content .token.prolog,.wl-content .token.doctype,.wl-content .token.cdata{color:#999}.wl-content .token.punctuation{color:#ccc}.wl-content .token.tag,.wl-content .token.attr-name,.wl-content .token.namespace,.wl-content .token.deleted{color:#e2777a}.wl-content .token.function-name{color:#6196cc}.wl-content .token.boolean,.wl-content .token.number,.wl-content .token.function{color:#f08d49}.wl-content .token.property,.wl-content .token.class-name,.wl-content .token.constant,.wl-content .token.symbol{color:#f8c555}.wl-content .token.selector,.wl-content .token.important,.wl-content .token.atrule,.wl-content .token.keyword,.wl-content .token.builtin{color:#cc99cd}.wl-content .token.string,.wl-content .token.char,.wl-content .token.attr-value,.wl-content .token.regex,.wl-content .token.variable{color:#7ec699}.wl-content .token.operator,.wl-content .token.entity,.wl-content .token.url{color:#67cdcc}.wl-content .token.important,.wl-content .token.bold{font-weight:bold}.wl-content .token.italic{font-style:italic}.wl-content .token.entity{cursor:help}.wl-content .token.inserted{color:green}.wl-recent-item p{display:inline}.wl-user-list{padding:0;list-style:none}.wl-user-list a,.wl-user-list a:hover,.wl-user-list a:visited{color:var(--waline-color);text-decoration:none}.wl-user-list .wl-user-avatar{position:relative;display:inline-block;overflow:hidden;margin-inline-end:10px;border-radius:4px;line-height:0}.wl-user-list .wl-user-avatar>img{width:var(--waline-user-avatar-size, 48px);height:var(--waline-user-avatar-size, 48px)}.wl-user-list .wl-user-badge{position:absolute;bottom:0;inset-inline-end:0;min-width:.7em;height:1.5em;padding:0 .4em;border-radius:4px;background:var(--waline-info-bgcolor);color:var(--waline-info-color);font-weight:bold;font-size:10px;line-height:1.5em;text-align:center}.wl-user-list .wl-user-item{margin:10px 0}.wl-user-list .wl-user-item:nth-child(1) .wl-user-badge{background:var(--waline-rank-gold-bgcolor, #fa3939);color:var(--waline-white);font-weight:bold}.wl-user-list .wl-user-item:nth-child(2) .wl-user-badge{background:var(--waline-rank-silver-bgcolor, #fb811c);color:var(--waline-white);font-weight:bold}.wl-user-list .wl-user-item:nth-child(3) .wl-user-badge{background:var(--waline-rank-copper-bgcolor, #feb207);color:var(--waline-white)}.wl-user-list .wl-user-meta{display:inline-block;vertical-align:top}.wl-user-list .wl-badge{display:inline-block;vertical-align:text-top;margin-inline-start:.5em;padding:0 .3em;border:1px solid var(--waline-badge-color);border-radius:4px;color:var(--waline-badge-color);font-size:var(--waline-badge-font-size)}.wl-user-wall{padding:0;list-style:none}.wl-user-wall .wl-user-badge,.wl-user-wall .wl-user-meta{display:none}.wl-user-wall .wl-user-item{position:relative;display:inline-block;transition:transform ease-in-out .2s}.wl-user-wall .wl-user-item::before,.wl-user-wall .wl-user-item::after{position:absolute;bottom:100%;left:50%;z-index:10;opacity:0;pointer-events:none;transition:all .18s ease-out .18s;transform:translate(-50%, 4px);transform-origin:top}.wl-user-wall .wl-user-item::before{content:\"\";width:0;height:0;border:5px solid rgba(0,0,0,0);border-top-color:rgba(16,16,16,.95)}.wl-user-wall .wl-user-item::after{content:attr(aria-label);margin-bottom:10px;padding:.5em 1em;border-radius:2px;background:rgba(16,16,16,.95);color:#fff;font-size:12px;white-space:nowrap}.wl-user-wall .wl-user-item:hover{transform:scale(1.1)}.wl-user-wall .wl-user-item:hover::before,.wl-user-wall .wl-user-item:hover::after{opacity:1;pointer-events:none;transform:translate(-50%, 0)}.wl-user-wall .wl-user-item img{width:var(--waline-user-avatar-size, 48px);height:var(--waline-user-avatar-size, 48px)}/*# sourceMappingURL=waline.css.map */"}],"posts":[{"title":"[MLSys'23] 训练与推理之间的“噪声”","slug":"sys-noise-mlsys23","date":"2024-06-13T15:47:09.000Z","updated":"2024-06-13T16:07:22.414Z","comments":true,"path":"2024/06/13/sys-noise-mlsys23/","permalink":"https://arrrr2.github.io/2024/06/13/sys-noise-mlsys23/","excerpt":"","text":"[MLSys’23] 训练与推理之间的“噪声”全文结构简单，实验充分（涵盖 CV 和部分 NLP），讲述了训练和推理之间可能导致精度下降的一些 gap ，某种程度上也解释了“为什么同样的方法，人家的效果好”；反过来也可以作为设计模型输入输出的一些 trick。此外，学习过程中也可以了解一点图像、模型训练和量化的基础知识。是很好的文章。 全文的重点在于解决了如下问题： 从训练到推理，有哪些不确定性会导致精度下降？ 这些不确定性会导致怎样的后果？ 如何解决这些不确定性？ 另外，文章提出了一个 benchmark 框架（此处略）。 训练和推理之间，有哪些 GAP？ 由图片所示，一个训练好的模型在推理的时候还会遭到各种噪声。不过考虑到它们其实是推理过程中的不一致性，叫“噪声”似乎不大准确。遗憾的是，从预处理到后处理，这种不一致十分充分冗杂，下面按照时间轴来。 预处理对于推理一张图像的过程来说，可能引入的操作有：解码（如Jpeg），色域转换和缩放。这三个过程都能带来不一致性： 解码：对于一张jpeg图像来说，它是如何被编码的？不管是怎样的有损压缩，为了减小体积都要丢弃一些高频信息。分辨高低频的方式就是离散余弦变换：对于每个8x8的小块，通过变换把图像分为低频成分和高频成分，解码的时候再通过高频低频成分做逆变换推出像素值。总之需要进行一些计算操作，但是显然浮点的操作比较费时费力且冗余较大，于是就有快速DCT变换（查表法）来加速。但是①不同的库里，查找表有些微不一致；②各类矩阵运算里可能有不同的上下取整带来的不同。 色域转换：神经网络里面的输入一般都是RGB格式，但是图像里面一般是YUV格式——Y是亮度，UV是色度。这之间的浮点转换显而易见的在不同库里可能有精度的区别；并且为了减小体积，人们经常会利用人眼对亮度更敏感的原理，把色度用更小的分辨率存起来，又造成了一点差异。 缩放：缩放的算法很多，如最邻近、双线性、三次、Lanczos等等。这些算法都会在保留细节和减少伪影做一些权衡。显然现在的算法也不大够好，要不然也不用AI放大了。不同的库会默认选择不同的算法，输入由此也变得不一样了。一图胜千言（3x）： 推理推理里面最直接的一点：量化！FP32, TF32, FP16, INT8，为了加速，各种各样的数据格式千奇百怪，如果直接做了量化，产生的值必然是不同的；并且如果原先用fp32计算出来的值很大或者很小，用fp16再计算，推理的时候必然会产生上下溢。 上采样的方式也会产生明显的影响，这一点和预处理的缩放一样，肉眼就很明显了，对于神经网络来说也做难怪会有影响。这一点对于图像分割的任务比较重要。 此外还有池化的上下修（我暂且先这么叫着）：如果池化核没法整除一个特征图（比如33x33的特征图，2x2的核），那么池化后的特征图大小也有待商榷，有的库会倾向于上修（17x17），有的则相反（16x16），这多出来或者少进去的一行一列也是对结果有影响的。 后处理把输出变成实际结果也要一点处理，比如非极大值抑制（NMS）里面各种框如何排序；Softmax里面如何舍入舍出等等。总之七七八八的还是那些问题。 GAP 的总结虽然说算法是具有确定性的，但是根据库的不同总会做一点不同。在此试图做一点另外一个角度的归纳。这些不同的原因大概有如下3点： 精度：不管是预处理还是推理还是后处理，都会涉及到浮点操作，于是受到精度的影响。但是精度是不一定的。 舍入：尺寸也好，输出值也好，如果要被量化（降低精度的时候），到底是向上取值还是向下取值，这是不一定的。 算法真的不一样。像插值或者图像解码中会遇到这种问题，这就真没什么好说的了。 原文做了一点可视化，可视化的结果就很明显： 影响多大？直接上实验：原文探究了解码、缩放、色域、精度、上下修以及各种操作都不同的影响。上表： 作者在图像分类、检测、分割以及NLP上面对能做的变化做了些实验。能够得到的几个结论： 推理精度的影响相对而言不大。图像分类里面fp16带来的下降基本都在0.1%以内，后面作者基本都不做了。int8带来的影响也不到1%，NLP也是。 模型越大越鲁棒。大体而言，模型越大，delta占比就越低。 原作对于NLP任务做的不多，CV任务还有几个结论： 实锤了“CNN模型关注细节，Transformer关注全局”。分类任务中，从CNN的角度来说，图像解码和缩放带来的细节区别远大于色域转换带来的全局差异。Transformer正好相反。 池化操作、特征图上采样、后处理很容易带来几个点的差异，使得更好的模型设计功亏一篑。 目标检测和分割任务对于图像预处理没那么敏感。 怎么办？现有方法一般来说，大家都会用加噪声、Augmix之类的方法进行数据增广；在对抗学习那里还会有一些对抗训练的方法。 然而比较遗憾的是各种增广都基于一个库的话神经网络是提前感知不到的。实验来看也是并没有甚么O用。直接上图： 作者提出的方法由于输入的影响很多时候是最大的，并且可以很容易复现（不同的库带来的不同实现方法，实际上import一下就改了），所以就把各种输入方法都喂进网络里就好。训练的时候只要随机挑一个库打开图片，随机用某一个库挑一种算法进行缩放，轻松地就能让网络学习到这些“噪声”。 很naive的idea，很简单粗暴，但是好用。 总结内容其实很简单，也不像是CV论文那样使用了各种fancy的方法，大体上都是以实验为主；最后提出的方法也很粗暴。但是整个文章实际上回答了一个很基础的问题：“为什么他点那么高，我死活就刷不出来？” 笔者在复现SR模型的时候发现过这个十分严重的问题，只要把退化时下采样方式从bicubic改成nearest，小模型上的PSNR可以轻松掉个2~3左右，提升这么大的值已经足够发一篇了。 另一个重要的点在于，在各种“精妙的设计”之下，还有很多基础的问题没有解决。正可谓 “Garbage in, garbage out”，这种严格要求数据的工程方法有时反倒能成为解决学术问题的关键。","categories":[],"tags":[]},{"title":"FFmpeg 从入门到升天：1) Linux 下编译安装","slug":"ffmpeg-install","date":"2023-12-22T06:45:00.000Z","updated":"2023-12-22T07:20:41.870Z","comments":true,"path":"2023/12/22/ffmpeg-install/","permalink":"https://arrrr2.github.io/2023/12/22/ffmpeg-install/","excerpt":"","text":"FFmpeg 好难用啊，但是又不能不用，我爱说实话。 说在前面本篇内容参照 https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu 在 2023.12.22 的内容进行翻译（整理）。如有问题，可以过去看教程。虽然各个 linux 发行版都可以直接安装，但是考虑到可能缺少编码器，难以 debug 等种种原因，总会有人选择手动编译安装。因此这篇教程就是这么用的。 多线程把 make 改成 make -j$(nproc)。不想使用全部的线程也可以指定，如 make -j8。 首先确定安装的位置在官方说明中，所有中间文件放在用户文件夹的 ffmpeg_sources 和 ffmpg_build 下。这里为方便整理，专门创建一个文件夹用于整理ffmpeg的文件：FFMPEG_PATH=$HOME/data/ffmpeg如果想完全按照官方，将所有内容放在用户文件夹下（即 &#x2F;home），那么只需要将上面改成FFMPEG_PATH=$HOME在 FFMPEG_PATH 下，先创建三个文件夹：mkdir -p $FFMPEG_PATH/ffmpeg_sources $FFMPEG_PATH/ffmpeg_build ~/bin 基础库的安装执行： 12345678910111213141516171819202122232425sudo apt-get update -qq &amp;&amp; sudo apt-get -y install \\ autoconf \\ automake \\ build-essential \\ cmake \\ git-core \\ libass-dev \\ libfreetype6-dev \\ libgnutls28-dev \\ libmp3lame-dev \\ libsdl2-dev \\ libtool \\ libva-dev \\ libvdpau-dev \\ libvorbis-dev \\ libxcb1-dev \\ libxcb-shm0-dev \\ libxcb-xfixes0-dev \\ meson \\ ninja-build \\ pkg-config \\ texinfo \\ wget \\ yasm \\ zlib1g-dev 根据官方说明，Ubuntu 20.04 还需执行sudo apt install libunistring-dev libaom-dev libdav1d-dev如果 libdav1d-dev 无法安装，可以先放弃，之后编译安装。 完事之后安装音视频相关的库。其中包括 x26x, vpx, aac, opus 和它们的依赖。sudo apt-get install nasm libx264-dev libx265-dev libnuma-dev libvpx-dev libfdk-aac-dev libopus-dev 没办法直接安装的库三个av1的编解码器：aom-av1, dav1d-av1, svt-av1虽然它们的功能是一致的，但考虑到可能具有不一样的特性，建议全部选装。vmaf 是视频质量的评价标准之一，科研中可能会用到，建议选装。其中，从 Ubuntu 22.04LTS 起 dav1d 提供了官方包，可以使用sudo apt-get install libdav1d-dev，不需要手动安装。 aom-av1： 1234567cd FFMPEG_PATH=$HOME/data/ffmpeg_sources &amp;&amp; \\git -C aom pull 2&gt; /dev/null || git clone --depth 1 https://aomedia.googlesource.com/aom &amp;&amp; \\mkdir -p aom_build &amp;&amp; \\cd aom_build &amp;&amp; \\PATH=&quot;$HOME/bin:$PATH&quot; cmake -G &quot;Unix Makefiles&quot; -DCMAKE_INSTALL_PREFIX=&quot;$FFMPEG_PATH/ffmpeg_build&quot; -DENABLE_TESTS=OFF -DENABLE_NASM=on ../aom &amp;&amp; \\PATH=&quot;$HOME/bin:$PATH&quot; make &amp;&amp; \\make install dav1d-av1： 1234567cd FFMPEG_PATH=$HOME/data/ffmpeg_sources &amp;&amp; \\git -C SVT-AV1 pull 2&gt; /dev/null || git clone https://gitlab.com/AOMediaCodec/SVT-AV1.git &amp;&amp; \\mkdir -p SVT-AV1/build &amp;&amp; \\cd SVT-AV1/build &amp;&amp; \\PATH=&quot;$HOME/bin:$PATH&quot; cmake -G &quot;Unix Makefiles&quot; -DCMAKE_INSTALL_PREFIX=&quot;$FFMPEG_PATH/ffmpeg_build&quot; -DCMAKE_BUILD_TYPE=Release -DBUILD_DEC=OFF -DBUILD_SHARED_LIBS=OFF .. &amp;&amp; \\PATH=&quot;$HOME/bin:$PATH&quot; make &amp;&amp; \\make install svt-av1: 1234567cd FFMPEG_PATH=$HOME/data/ffmpeg_sources &amp;&amp; \\git -C dav1d pull 2&gt; /dev/null || git clone --depth 1 https://code.videolan.org/videolan/dav1d.git &amp;&amp; \\mkdir -p dav1d/build &amp;&amp; \\cd dav1d/build &amp;&amp; \\meson setup -Denable_tools=false -Denable_tests=false --default-library=static .. --prefix &quot;$FFMPEG_PATH/ffmpeg_build&quot; --libdir=&quot;$FFMPEG_PATH/ffmpeg_build/lib&quot; &amp;&amp; \\ninja &amp;&amp; \\ninja install libvmaf: 12345678cd FFMPEG_PATH=$HOME/data/ffmpeg_sources &amp;&amp; \\wget https://github.com/Netflix/vmaf/archive/v2.3.1.tar.gz &amp;&amp; \\tar xvf v2.3.1.tar.gz &amp;&amp; \\mkdir -p vmaf-2.3.1/libvmaf/build &amp;&amp;\\cd vmaf-2.3.1/libvmaf/build &amp;&amp; \\meson setup -Denable_tests=false -Denable_docs=false --buildtype=release --default-library=static .. --prefix &quot;$FFMPEG_PATH/ffmpeg_build&quot; --bindir=&quot;$HOME/bin&quot; --libdir=&quot;$FFMPEG_PATH/ffmpeg_build/lib&quot; &amp;&amp; \\ninja &amp;&amp; \\ninja install 安装 FFMPEG最后一步，愉快执行 123456789101112131415161718192021222324252627282930cd FFMPEG_PATH=$HOME/data/ffmpeg_sources &amp;&amp; \\wget -O ffmpeg-snapshot.tar.bz2 https://ffmpeg.org/releases/ffmpeg-snapshot.tar.bz2 &amp;&amp; \\tar xjvf ffmpeg-snapshot.tar.bz2 &amp;&amp; \\cd ffmpeg &amp;&amp; \\PATH=&quot;$HOME/bin:$PATH&quot; PKG_CONFIG_PATH=&quot;$FFMPEG_PATH/ffmpeg_build/lib/pkgconfig&quot; ./configure \\ --prefix=&quot;$FFMPEG_PATH/ffmpeg_build&quot; \\ --pkg-config-flags=&quot;--static&quot; \\ --extra-cflags=&quot;-I$FFMPEG_PATH/ffmpeg_build/include&quot; \\ --extra-ldflags=&quot;-L$FFMPEG_PATH/ffmpeg_build/lib&quot; \\ --extra-libs=&quot;-lpthread -lm&quot; \\ --ld=&quot;g++&quot; \\ --bindir=&quot;$HOME/bin&quot; \\ --enable-gpl \\ --enable-gnutls \\ --enable-libaom \\ --enable-libass \\ --enable-libfdk-aac \\ --enable-libfreetype \\ --enable-libmp3lame \\ --enable-libopus \\ --enable-libsvtav1 \\ --enable-libdav1d \\ --enable-libvorbis \\ --enable-libvpx \\ --enable-libx264 \\ --enable-libx265 \\ --enable-nonfree &amp;&amp; \\PATH=&quot;$HOME/bin:$PATH&quot; make &amp;&amp; \\make install &amp;&amp; \\hash -r 收尾现在安装就已经全部完成，接下来执行 1source ~/.profile 重启 shell ，输入 ffmpeg 即可运行。 最后执行 1unset FFMPEG_PATH 释放目录变量。 可能遇到的问题1 nasm libx264-dev libx265-dev libnuma-dev libvpx-dev libfdk-aac-dev libopus-dev 我都想手动编译。去 https://trac.ffmpeg.org/wiki/CompilationGuide/Ubuntu 查看教程。 2 为什么最后装在 $HOME&#x2F;bin 文件夹下？参照官方说法，放在这个位置不影响系统文件、不和安装的包（包括 ffmpeg ）冲突，方便卸载或者移动，不需要root权限。 3 如何卸载？删除 $HOME&#x2F;bin 下有关 ffmpeg 的文件夹即可。rm -rf ~/bin/&#123;ffmpeg,ffprobe,ffplay,x264,x265,nasm&#125;如果想要执行之前的临时文件，可以执行rm -rf $FFMPEG_PATH$FFMPEG_PATH 为当时设置的目录，其实手动删除即可。 4 我连不上外网两种办法可供参考：爬梯子，或者在本地把库下载了之后拷到 ffmpeg_resource 文件夹之下，再把开头为 git 或 wget 的那一行去掉。","categories":[],"tags":[]},{"title":"Hello World!","slug":"Hello-World","date":"2023-11-29T06:45:00.000Z","updated":"2023-11-29T06:45:55.938Z","comments":true,"path":"2023/11/29/Hello-World/","permalink":"https://arrrr2.github.io/2023/11/29/Hello-World/","excerpt":"","text":"Hello World!","categories":[],"tags":[]}],"categories":[],"tags":[]}